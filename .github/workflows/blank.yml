name: CI Only (Notify Discord)

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

jobs:
  ci:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: CI pass check
        run: |
          echo "CI succeeded"
          echo "Branch: ${GITHUB_REF}"
          echo "Commit: ${GITHUB_SHA}"
          ls -al

      # âœ… CI ì„±ê³µ ì‹œ Discord ì•Œë¦¼
      - name: Notify Discord (Success)
        if: success()
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{
                 "username": "GitHub CI",
                 "content": "âœ… **CI SUCCESS**\nğŸ“¦ Repo: '"${GITHUB_REPOSITORY}"'\nğŸŒ¿ Branch: '"${GITHUB_REF_NAME}"'\nğŸ”‘ Commit: '"${GITHUB_SHA}"'"
               }' \
               ${{ secrets.DISCORD_URL }}

      # âŒ CI ì‹¤íŒ¨ ì‹œ Discord ì•Œë¦¼
      - name: Notify Discord (Failure)
        if: failure()
        run: |
          curl -H "Content-Type: application/json" \
               -X POST \
               -d '{
                 "username": "GitHub CI",
                 "content": "âŒ **CI FAILED**\nğŸ“¦ Repo: '"${GITHUB_REPOSITORY}"'\nğŸŒ¿ Branch: '"${GITHUB_REF_NAME}"'\nğŸ”‘ Commit: '"${GITHUB_SHA}"'\nğŸ” Check Actions log for details."
               }' \
               ${{ secrets.DISCORD_URL }}
